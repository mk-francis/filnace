## 目标
- 在集团视图下：除“全部/收入/支出”外的类别筛选跟随具体分公司；列表条目显示公司标识。
- 录入/编辑弹窗支持“两级选择”：先选分公司，再选该公司的类别；类别随分公司联动。
- 新增/编辑交易时强制写入对应公司，避免“全部分公司”下的落库不明确。

## 数据层改造
- Store新增公司类别配置：`categoriesByCompany = { company1: ['修车','零件','维保','空调','工资','其他'], company2: ['改装','零件','维保','工资','其他'], company3: ['空调','设备','维保','工资','其他'] }`
- API：
  - `getCompanyCategories(companyId)`返回该公司类别列表
  - `addCompanyCategory(companyId, name)`/`removeCompanyCategory(...)`（后续扩展）
- 交易模型保持`type`（income/expense）+`category`（业务类别）+`companyId`必填；在集团视图新增交易时必须显式选择公司。

## 仪表板 index.html
- 顶部维持`集团选择 + 公司选择（含全部分公司）`。
- 类别筛选行为：
  - 当`company === 'all'`时，仅展示“全部/收入/支出”三项；点击其他类别提示需先选择公司或在弹窗内选择公司。
  - 当选择具体公司时，展示该公司的类别chips（修车/改装/空调/零件/维保/工资/其他）。
- 最近交易：始终显示公司名徽标（集团视图下合并显示）。
- 录入弹窗：
  - 新增“公司”下拉，默认跟随当前公司；若在`all`视图，默认第一个公司。
  - “类别”下拉按所选公司动态填充；切换公司时同步类别选项。
  - 提交时用所选公司ID写库。

## 交易页面 transactions.html
- 顶部选择器：`集团`+`公司（含全部分公司）`。
- 筛选chips：
  - `全部/收入/支出`始终可用
  - 当公司为具体值时，展示该公司类别chips；当公司为`all`，类别chips显示“公司-类别”（如`ABC修车行-修车`），也可选择其中一个进行过滤。
- 列表：在描述下方始终显示公司名徽标。
- 录入/编辑弹窗：添加“公司”下拉，类别随公司联动；编辑时公司与类别预填。
- 保存逻辑：在`all`视图新增时，必须选择公司（校验）；编辑时按记录的`companyId`更新对应公司数据。

## 报表与预算
- 报表维持集团聚合，不改类别结构。
- 预算页保持公司选择；若需要，也可在列表项右侧显示公司徽标（已支持）。

## 交互与校验
- 当在`all`视图点击公司类别chips或尝试提交而未选择公司时，给出提示：`请先选择分公司`。
- 金额、日期等维持现有校验与本地化格式。

## 实施步骤
1. Store：新增`categoriesByCompany`与`getCompanyCategories`等方法；确保`addTransaction`强制需要`companyId`。
2. index.html：录入弹窗加入公司下拉，类别联动；更新提交逻辑；类别chips联动公司选择；在集团视图仅显示全局chips。
3. transactions.html：同上，改筛选chips与弹窗双下拉；过滤逻辑支持“公司-类别”。
4. 统一在列表与最近交易加公司徽标；在集团视图下chips目标为`company+category`组合。
5. 验证与硬刷新说明：清空`localStorage`后重试，确保新结构生效。

## 成功标准
- 在集团视图下，除“全部/收入/支出”外的类别都与所选分公司绑定；列表与筛选能正确显示并过滤。
- 弹窗两级选择可用，提交能正确写入对应公司；编辑能在合并视图下正常工作。

请确认该方案，我将开始实施并更新页面与数据仓库实现上述联动与校验。