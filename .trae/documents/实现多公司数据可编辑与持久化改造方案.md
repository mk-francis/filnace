## 目标
- 让三家公司（ABC修车行、Custom Motors PH、CoolTech空调服务）的数据可编辑（新增/修改/删除），不再依赖硬编码。
- 编辑内容即时生效，仪表板、交易、预算、报表均按最新数据联动更新。
- 数据在浏览器端持久化，刷新页面后仍保留；统一使用菲律宾比索展示与本地化格式。

## 问题诊断
- 仪表板与图表数据硬编码在页面脚本中：`index.html:565–744, 823–887, 991–1026`。
- 交易/预算页面的编辑函数是占位：`transactions.html:815–818`、`budget.html:913–915`；导出也为占位：`transactions.html:829–832`。
- 报表数据硬编码：`reports.html:449–510`，与公司/期间无真实联动。

## 数据层设计（先落地LocalStorage，后续可升IndexedDB）
- 先实现无后端的前端持久化：`localStorage`+内存缓存，满足当前体量与快速上线。
- 数据结构（key → value）：
  - `companies`: `[ { id, name, businessType } ]`
  - `transactions`: `{ [companyId]: Array<Transaction> }`
  - `budgets`: `{ [companyId]: Array<Budget> }`
  - `settings`: `{ currency: 'PHP', locale: 'en-PH' }`
- 类型：
  - `Transaction = { id, date, description, category, amount, paymentMethod, status, type, notes }`
  - `Budget = { id, name, department, allocated, spent, period, startDate, endDate, description, status }`
- 首次加载种子数据：把现有三家公司的示例数据写入存储，保证视觉与统计不突变。
- 提供聚合查询：按公司/期间聚合收入、支出、利润、月度序列、预算执行率等，供各页使用。
- 未来扩展：当数据量增大或需要更复杂查询时，平滑迁移到 `IndexedDB`。

## 公共模块与工具（最少新文件）
- 新增一个共享脚本：`assets/js/store.js`
  - `initSeed()`, `getCompanies()`, `addCompany()`, `updateCompany()`, `removeCompany()`
  - `getTransactions(companyId)`, `addTransaction()`, `updateTransaction()`, `removeTransaction()`
  - `getBudgets(companyId)`, `addBudget()`, `updateBudget()`, `removeBudget()`
  - `aggregateDashboard(companyId, period)`: 返回收入/支出/利润与图表序列
  - `aggregateReports(companyId, period, type)`: 生成利润表/现金流/资产负债表数据
  - 内部统一读写`localStorage`并维护内存缓存
- 新增一个轻量工具脚本：`assets/js/utils.js`
  - `formatCurrency(number)`: 使用`Intl.NumberFormat('en-PH',{ style:'currency', currency:'PHP' })`
  - `formatDate(date)`, `parseDate(str)`, 通用排序/分页工具
- 所有页面`<script>`开头加载这两个文件，随后调用原有初始化流程但数据源改为`store`。

## 页面改造
- 仪表板 `index.html`
  - 用 `store.aggregateDashboard(companyId, period)` 替换硬编码数据：`index.html:823–849, 852–887`。
  - 图表初始化改为使用聚合序列（现金流/收支比例/预算仪表）：`index.html:565–744`。
  - 快速操作“添加收入/记录支出”表单提交写入 `transactions`，成功后重算并刷新指标与图表：`index.html:813–819`。
  - 数字动画 `animateNumbers/animateValue` 保留，但数据源来自聚合结果。
- 交易记录 `transactions.html`
  - `loadTransactions()` 改为读取 `store.getTransactions(currentCompanyId)` 并渲染：`transactions.html:524–552`。
  - 完成 `editTransaction(id)`：弹出编辑模态，保存后 `store.updateTransaction` 并刷新列表与统计：`transactions.html:815–818`。
  - 完成 `deleteTransaction(id)`：`store.removeTransaction` 并刷新：`transactions.html:820–827`。
  - 完成导出：将当前公司交易导出为 JSON 文件；可选支持导入：`transactions.html:829–832`。
  - 筛选/搜索/排序/分页逻辑复用，数据源改为当前过滤后的 `store` 数据。
- 预算管理 `budget.html`
  - 列表与卡片数据改为 `store.getBudgets(companyId)`：`budget.html:715–804`。
  - 完成 `editBudget(id)` 与删除：`budget.html:913–923`；新增预算使用 `store.addBudget`：`budget.html:889–910`。
  - 趋势与分配图表使用 `budgets` 聚合数据：`budget.html:490–601`。
- 财务报表 `reports.html`
  - 依据 `store.aggregateReports(companyId, period, type)` 生成三大报表：替换硬编码 `reports.html:449–510`。
  - 报表类型切换与期间选择即时重算并更新表格与图表：`reports.html:656–676`。
  - 报表历史可记录用户生成动作（存入 `localStorage` 供侧栏显示）：`reports.html:631–653`。

## 本地化与货币
- 全站金额展示统一调用 `formatCurrency`，替换现有模板字符串位置（示例：`index.html:762`, `transactions.html:577`, `budget.html:753`）。
- 日期与数字格式按 `en-PH` 保持菲律宾市场习惯；继续显示货币符号`₱`。

## 数据导入/导出
- 交易与预算页面提供 JSON 导出；可选提供导入以便迁移历史数据与批量编辑。
- 结构校验与失败提示（使用现有 `showNotification`）。

## 验证与兼容
- 首次加载执行 `initSeed()` 注入三家公司与示例数据，视觉指标与图表保持与当前一致。
- 刷新页面后数据不丢失；公司切换与期间筛选即时联动。
- 保留现有 UI/动效与 Tailwind 风格，尽量不改样式结构。

## 里程碑
- 第1阶段：数据仓库与仪表板联动（1–2天）
- 第2阶段：交易CRUD与导出（1–2天）
- 第3阶段：预算CRUD与图表联动（1–2天）
- 第4阶段：报表聚合生成与历史记录（1–2天）
- 第5阶段：可选导入、清理未使用库（`Matter.js`, `p5.js`）与小型优化（1天）

## 成功标准
- 三公司数据均可编辑；刷新后仍保留。
- 仪表板、交易、预算、报表均不再依赖硬编码，编辑后可见并联动更新。
- 金额格式统一为菲律宾比索，体验与性能与当前版本一致或更好。

请确认以上方案，我将按阶段开始实施并提交具体改动。